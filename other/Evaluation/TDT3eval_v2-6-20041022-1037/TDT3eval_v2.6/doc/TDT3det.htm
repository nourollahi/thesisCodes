<!-- $Id: TDT3det.htm,v 1.4 2001/12/21 15:04:25 jon Exp $ -->
<HTML>
<HEAD>
<CENTER><TITLE>TDT3det.pl User Manual</TITLE></CENTER>
<A NAME="TDT3det.pl"> <B><BIG><CENTER>TDT3det.pl User Manual</CENTER></BIG></B></A>

<BR>
<CENTER> <H1> TDT3 Detection Task Scoring </H1> </CENTER>

</HEAD>

<BODY><p><hr>


<H1>Usage:</H1>
<DIR>
	TDT3det.pl -R Rootdir -i 
	<A HREF="TDT3det.htm#DetIndexFormat"> TDT3_det_index</A> &lt;Options&gt; 
	<A HREF="TDT3det.htm#DetOutputFormat"> Det_system_output</A>
</DIR>

<P>The 'TDT3det.pl' program will score the output generated by a TDT3
detection system.  The program requires the directory path,
'Rootdir', to the LDC's TDT3 Test corpus.  The corpus must be in the
same structure as released by the LDC, with all file formats identical
to their original form.  The program uses the index file <A HREF="TDT3det.htm#DetIndexFormat"> TDT3_det_index</A>,
provided with the test corpus and described below, to load the
appropriate data from the corpus and to verify the completeness of the
<A HREF="TDT3det.htm#DetOutputFormat"> Det_system_output</A> file.

<P> Upon completion of the load, the detection decisions are scored,
and a report is generated.  The scoring of an Automatic Topic
Detecting System (ATDS) consists of two phases, first, the decisions
output by the ATDS must be mapped onto the story boundaries annotated
in the reference corpus.  Then, topic sets are built for both the
reference and hypothesis data and the best scoring correspondences
between the ref and hyp clusters, according to the "Detection Cost
Function" (DCF), are scored.

<P> The TDT3det.pl program can use two methods of mapping topic
decisions to reference stories, <i>majority vote</i> or <i>impulse
vote</i>.  The two methods differ in the meaning implied by decision
marker output by the ATDS.

<DIR>
<bold> Majority Vote</bold>
<dir>
Each story decision is computed as the majority of decisions over all words (or time)
in that story, and each story score is computed as the average score over all words (time) 
in that story.  Ties in computing the decisions are broken by choosing the decision with
the maximum score.
</dir>
<bold> Impulse Vote</bold>
<dir>
Each story decision is made by selection the decision with the maximum score within
the boundaries of the story.  In the event no decisions were made for the story, the
decision is 'NO' with a score of -infinity.
</dir>
</DIR>

<P> Once the hypothesized topic decisions and scores are assigned to the
ref stories, topic clusters are built for both the ref
and hyp topic sets.  Since no direct correspondences exist between
the ref and hyp topic identifiers, a detection cost function is used to 
find a mapping.  The detection cost function can be found in the 
<A HREF="tdt3_plan.ps"> The Topic Detection and Tracking
(TDT3) Evaluation Plan</a> <A HREF="tdt3_plan.doc">(In Microsoft Word)</a>.  The options '-P' and '-C' modify the behavior of the cost function.

<P> The program concludes it processing by first generating a <A
HREF="#report">detection performance report</a> and then optionally a 
Decision Error Tradeoff (DET) graph.  As part of the report, 
the program computes the <A HREF="cluster/cluster-evaluation_cost-based.ps">Cost-Based YDZ measure</A> at several 
ratios of the cost of a story examination to the cost of missing a story.

<P> The following &lt;Options&gt; are recognized by the program:

<DIR>
<TABLE BORDER=2> 
<TR> <TD> -C Cmiss:Cfa <TD> -> <TD> Set the cost of a missed detection and the cost of a
	false alarm to 'Cmiss' and 'Cfa' respectively.  These numbers are used in the 
	detection cost function.  Default values are Cmiss=1.0 and Cfa=0.1 ;
<TR> <TD> -D Detail <TD> -> <TD> Write internally organize evaluation corpus and pertinent 
			statistics for debugging purposes.  This report, though voluminous, is
			intended to help researchers debug their internal versions of
			evaluation code.
<TR> <TD> -j topicrel[:topicrel]* <TD> -> <TD> Specify alternative topic relevance files via the command line.  More than one can be specified by concatenating the file names using a colon ':' separator.
<TR> <TD> -L      <TD> -> <TD> After Loading the database, dump it to stdout and exit.
<TR> <TD> -m func <TD> -> <TD> Set the system output to story mapping function to 
	either 'majority' or 'impulse'.  Default is 'majority'.
<TR> <TD> -P P(topic) <TD> -> <TD> Use P(topic) for the detection cost function to map
	topic clusters.  Default is 0.02.
<TR> <TD> -r Report <TD> -> <TD> Write the summary report to 'Report' rather than STDOUT, the default.
<TR> <TD> -s <TD> -> <TD> Use all available speedups.  Currently, the only speedups involve 
			  NOT using 'nsmgls' and 'SGMLS.pm' parser and PERL libraries to read 
			  the TDT3 Corpus files. 
<TR> <TD> -S <A HREF="ssd.htm">SubsetFile</A> <TD> -> <TD> Compute detection performance over the subsets defined in 'SubsetFile'.  See the documentation below for a description of the file's format.
<TR> <TD> -E <A HREF="ssd.htm">SubsetFile</A> <TD> -> <TD> Compute performance excluding source files in the subset definition file.  The application of this filter is global, in that the source file is ignored prior to establishing subsets defined by the -S option.  NOTE: Only the first set defined in the subset definition file is used for the filter.  All others are ignored. 
<TR> <TD> -v num <TD> -> <TD> Set the verbose level to 'num'. Default 1.<BR>
	                   ==0 None, ==1 Normal, >5 Slight, >10 way too much, >15 not even funny

<TR> <TD COLSPAN=3> <b><center>Options that apply to the DET plots:</center></b>
<TR> <TD> -d DETfile <TD> -> <TD> Create a DET plot in GNUplot format with the file
	root 'DETfile'.  The program makes several files each with additional extensions.
	The file 'DETfile'.plt is a command file for GNUplot and can be printed using the
	command "gnuplot 'DETfile'.plt | lpr".  The default plot produces a line trace for
	each line in the 'Trk_system_output_list' list.  The options below modify this.
<TR> <TD> -t title <TD> -> <TD> Set the title line for the plot to 'title'.
<TR> <TD> -T Topic_regexp <TD> ->  <TD> Restrict the topics for which the  index files
			are created using the PERL regular expression 'Topic_regexp'.  The default
			is to use all occurring annotated topics.  There are a number of macro names
			for defined topic sets that may be used in place of regular expressions, 
			they are:
			<DIR>
			<table border=2> 
			<tr> <TH> Macro name </TH> <TH> Equivalent Expression </TH> </TR>
			<tr> <TD> TDT98_Train     </TD> <TD> 20+([1-9]|[12][0-9]|3[0-7])</TD></TR>
			<tr> <TD> TDT98_DevTest   </TD> <TD> 20+(3[89]|[45][0-9]|6[0-6])</TD></TR>
			<tr> <TD> TDT98_EvalTest  </TD> <TD> 20+(6[7-9]|[89][0-9]|100)</TD></TR>
			<tr> <TD> TDT99_mul       </TD> <TD> 20+(1|2|5|7|13|15|20|23|39|44|48|57|70|71|76|85|88|89|91|96)</TD></TR>
			</table>
			</DIR>
</TABLE>
</DIR>

<A NAME="DetIndexFormat"> <H2> Detection Task Index File Format </H2> </A>

The index file for the detection file is as follows.  The first
line in the index file is a header line.  The line indicates the TDT3
task, 'DETECTION' in this case, and the type of pointer used to
mark segment changes.  Each subsequent data record in the file will
identify a source file to process. These records will have one field
and be separated with a newline.

<P> The BNF structure of the detection index file is:
	
<DIR>
	&lt;HEADER_LINE&gt; <BR>
	&lt;SOURCE&gt;	<BR>
	&lt;SOURCE&gt;	<BR>
	...
	<P>	

Where:
	<DIR>
	<TABLE BORDER=2>
	<TR> <TD> &lt;HEADER_LINE&gt;   <TD> :== <TD> <B>  # DETECTION &lt;POINTER_TYPE&gt; </B>
	<TR> <TD> <DIR>  &lt;POINTER_TYPE&gt; </DIR>  <TD> :== <TD> <B>  RECID | TIME </B> <BR>
		A POINTER_TYPE is the type of boundaries to be output by the
		system. The possible values are RECID for text stream
		detection or TIME for audio detection.
	<TR> <TD> &lt;SOURCE&gt; <TD> :== <TD> TDT3 corpus filename with
			directory and extension names relative to the TDT3
			root directory specified on the command line.
	</TABLE>
	</DIR>

</DIR>

The following is an excerpt from a detection task index file.

<DIR>
<pre>
# DETECTION RECID
tkntext/19980301_0553_0719_APW_ENG.tkn
tkntext/19980301_1014_1116_APW_ENG.tkn
tkntext/19980301_1403_1529_APW_ENG.tkn
tkntext/19980301_2139_2341_APW_ENG.tkn
tkntext/19980302_0630_0651_APW_ENG.tkn
</PRE>
</DIR>

<A NAME="DetOutputFormat"><H2> Detection Task System Output Format </H2></A>


The Topic Identification task is to detect topics and then to
hypothesize points in the source stream where they are
discussed. Topic Identification systems will perform this task by
recording information about these hypothesized points in a file, one
record for each putative discussion of a topic, written in ASCII
format. The first record in this file will contain four fields which
specify information that applies globally to the whole file. 

Comment lines begin with the '#' character, and any text following a
'#' is ignored.  The exception to this rule is the first comment line
can optionally contain a long description of the system under test.  This
description will be included in the scoring report along side the
&lt;SYSTEM&gt; value described below.  After the initial comment line,
blank lines are treated as comments.

<P> The BNF structure of the detection system output file is:
	
<DIR>
	&lt;SYSTEM&gt; &lt;BOUNDARIES&gt; &lt;DEF_PERIOD&gt; &lt;POINTER_TYPE&gt; <BR>
	&lt;DECISION_LINE&gt; <BR>
	&lt;DECISION_LINE&gt; <BR>
	...
	<P>	

Where:
	<DIR>
	<TABLE BORDER=2>
	<TR> <TD> &lt;SYSTEM&gt; <TD> :== <TD> System is an alphanumeric
			character string that uniquely identifies the
			system being tested. (E.g., CDM_P05-8.v37)
	<TR> <TD> &lt;BOUNDARIES&gt; <TD> :== <TD> Boundaries is either
			YES or NO, where YES indicates that story
			boundaries are supplied to the system being
                        tested and NO indicates that they are not.

	<TR> <TD> &lt;DEF_PERIOD&gt;   <TD> :== <TD> The deferral period before
						before decisions are made.
						Permissible values defined by
						the TDT3 test specification.
	<TR> <TD> &lt;POINTER_TYPE&gt; <TD> :== <TD> <B>  RECID | TIME </B> <BR>
		POINTER_TYPE is the type of boundaries to be output by
		the system. The possible values are RECID for text
		stream detection or TIME for audio detection.

	<TR>

	<TR> <TD> &lt;DECISION_LINE&gt; <TD> :== <TD>
		&lt;TOPIC&gt; &lt;SOURCE&gt; &lt;POINTER&gt; &lt;DECISION&gt;
		&lt;SCORE&gt;
	<TR> <TD> <DIR> &lt;TOPIC&gt; </DIR> <TD> :== <TD>
		 TDT3 detection system defined topic identifier.
	<TR> <TD> <DIR> &lt;SOURCE&gt; </DIR> <TD> :== <TD> TDT3 corpus filename with
			directory and extension names relative to the TDT3
			root directory specified on the command line.
	<TR> <TD> <DIR> &lt;POINTER&gt; </DIR> <TD> :== <TD> POINTER is a
		hypothesized decision point. For text files, Pointer is the
		index number of the first word in the hypothesized
		segment, in the range {1, 2, . . .}. For audio files,
		Boundary is the time of the beginning of the segment
		{0.0, . . .}. (It isn't necessary to output the
		beginning of the first segment.) The hypothesized
		Boundary points must occur in chronological order.

	<TR> <TD> <DIR> &lt;DECISION&gt; </DIR> <TD> :== <TD>
                        Decision is either YES or NO, where YES
			indicates that the system believes that the
			story being processed
                        discusses the target topic, and NO indicates not.
	<TR> <TD> <DIR> &lt;SCORE&gt; </DIR> <TD> :== <TD> 
                       Score is a real number which indicates how
			confident the system is that the story being
			processed discusses the associated topic. More
			positive values indicate greater confidence.


	</TABLE>
	</DIR>


</DIR>
	
The following is an excerpt from a detection system output file.

<DIR>
<PRE>
# Degenerate detection results, Errors, RECID
Errors NO 10 RECID
176 asrtext/19980307_1130_1200_CNN_HDL.asr 1 NO 0.209696400470383
177 asrtext/19980307_1130_1200_CNN_HDL.asr 66 NO 0.0652269882628861
178 asrtext/19980307_1130_1200_CNN_HDL.asr 254 NO 0.00793375334496783
179 asrtext/19980307_1130_1200_CNN_HDL.asr 318 NO 0.000951696625507463
170 asrtext/19980307_1130_1200_CNN_HDL.asr 675 NO 2.05484371633647e-10
144 asrtext/19980307_1130_1200_CNN_HDL.asr 762 YES 0.999999999524702
</PRE>
</DIR>

<A name="report"><H2> Example Output Report </H2></A>

<DIR>
<PRE>
-------------------------------------------------------------------------------
-------------------  TDT Detection Task Performance Report  ------------------


Story Weighted Detection: P(Miss)       = 0.1143
                          P(Fa)         = 0.0028
                          Cdet          = 0.0050

Topic Weighted Detection: P(Miss)       = 0.0723
                          P(Fa)         = 0.0028
                          Cdet          = 0.0042

Detection Performance Calculations:

    Ref.   Hyp.    # Ref  # Sys.  # Corr  # Miss  # Fa   | # Test                           
    Topic  Topic   Story  Story   Story   Story   Story  | Story   P(Miss)  P(Fa)   Cdet    
    -----  -----   -----  -----   ------  ------  -----  | ------  -------  -----   --------
    40     140       3      6       3       0       3    | 3085    0.0000   0.0010  0.0010  
    41     141      13     25      12       1      13    | 3085    0.0769   0.0042  0.0057  
    42     142      17     21      14       3       7    | 3085    0.1765   0.0023  0.0058  
    44     144      24     45      21       3      24    | 3085    0.1250   0.0078  0.0102  
    46     146       3      4       3       0       1    | 3085    0.0000   0.0003  0.0003  
    52     152       5      6       4       1       2    | 3085    0.2000   0.0006  0.0046  
    53     153       3      9       3       0       6    | 3085    0.0000   0.0019  0.0019  
    56     156       2     14       2       0      12    | 3085    0.0000   0.0039  0.0038  
    =====  =====   =====  =====   ======  ======  =====  | ======  =======  =====   ========
    Story  Weight                                                  0.1143   0.0028  0.0050  
    Topic  Sums     70    130      62       8      68    | 24680   
    Topic  Means     8.8   16.2     7.8     1.0     8.5  | 3085.0  0.0723   0.0028  0.0042  


Cost Based YDZ Calculations:

    Cexam  Cmiss   Ccluster    Cmin    Cmax        Cnorm   
    -----  -----   --------    ----    ----        -----   
    1      1       384.70      126.00  24749.65    0.010506
    1      10      662.36      126.00  25376.47    0.021242
    1      100     3438.97     126.00  31644.67    0.105111
    1      1000    31205.04    126.00  94326.68    0.329924
    1      10000   308865.76   126.00  721146.77   0.428198
    1      100000  3085472.90  126.00  6989347.75  0.441444


Detection Performance by Test Subset:

    Sub-      || Ref.   Hyp.    # Ref  # Sys.  # Corr  # Miss  # Fa   | # Test                           
    set       || Topic  Topic   Story  Story   Story   Story   Story  | Story   P(Miss)  P(Fa)   Cdet    
    ----      || -----  -----   -----  -----   ------  ------  -----  | ------  -------  -----   --------
    Audio     || 40     140       2      4       2       0       2    | 1446    0.0000   0.0014  0.0014  
    Audio     || 41     141      10     16       9       1       6    | 1446    0.1000   0.0042  0.0061  
    Audio     || 42     142      13     19      10       3       6    | 1446    0.2308   0.0042  0.0087  
    Audio     || 44     144      13     20      11       2       7    | 1446    0.1538   0.0049  0.0079  
    Audio     || 46     146       3      4       3       0       1    | 1446    0.0000   0.0007  0.0007  
    Audio     || 52     152       0      1       0       0       1    | 1446    0.0000   0.0007  0.0007  
    Audio     || 53     153       2      5       2       0       3    | 1446    0.0000   0.0021  0.0020  
    Audio     || 56     156       2      5       2       0       3    | 1446    0.0000   0.0021  0.0020  
    ====      || =====  =====   =====  =====   ======  ======  =====  | ======  =======  =====   ========
    Audio     || Story  Weight                                        |         0.1333   0.0025  0.0051  
    Audio     || Topic  Sums     45     74      39       6      29    | 11568   
    Audio     || Topic  Means     5.6    9.2     4.9     0.8     3.6  | 1446.0  0.0606   0.0025  0.0037  
    
    
    Newswire  || 40     140       1      2       1       0       1    | 1639    0.0000   0.0006  0.0006  
    Newswire  || 41     141       3     10       3       0       7    | 1639    0.0000   0.0043  0.0042  
    Newswire  || 42     142       4      5       4       0       1    | 1639    0.0000   0.0006  0.0006  
    Newswire  || 44     144      11     28      10       1      17    | 1639    0.0909   0.0104  0.0121  
    Newswire  || 46     146       0      0       0       0       0    | 1639    0.0000   0.0000  0.0000  
    Newswire  || 52     152       5      6       4       1       1    | 1639    0.2000   0.0006  0.0046  
    Newswire  || 53     153       1      4       1       0       3    | 1639    0.0000   0.0018  0.0018  
    Newswire  || 56     156       0      9       0       0       9    | 1639    0.0000   0.0055  0.0054  
    ====      || =====  =====   =====  =====   ======  ======  =====  | ======  =======  =====   ========
    Newswire  || Story  Weight                                        |         0.0800   0.0030  0.0045  
    Newswire  || Topic  Sums     25     64      23       2      39    | 13112   
    Newswire  || Topic  Means     3.1    8.0     2.9     0.2     4.9  | 1639.0  0.0364   0.0030  0.0037  
    
    


Execution parameters:

Index File:              ../indexes_devtest/det_nwt+asr.ndx
System Output File:      det_nwt+asr.det
Pointer Type:            RECID
Topic cluster Mapping Function:
              P(topic) = 0.02
              Cmiss    = 1
              Cfa      = 1
              Topic inclusion by: hard_decision

Detection Performance Calculations:
    System Identifier:   Errors 'Degenerate detection results, Errors, RECID'
    Deferral Period:     10

System Output to Story Mapping Function:  'majority'

----------------  End of TDT Detection Task Performance Report  ---------------
-------------------------------------------------------------------------------
Successful Completion

</PRE>
</DIR>

</BODY>
</HTML>
